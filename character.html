<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>3匹のセレクトページ - CSS黒目調整版</title>
    <link rel="stylesheet" href="./css/style.css">
    <style>
        /* --- 前半のスタイルは維持 --- */
        body {
            margin: 0;
            overflow: hidden;
            background-color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            font-family: sans-serif;
        }

        .menu {
            margin-top: 20px;
            z-index: 100;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 12px 24px;
            cursor: pointer;
            border: none;
            border-radius: 30px;
            background: white;
            font-weight: bold;
        }

        button.active {
            background: #ff6b6b;
            color: white;
        }

        #stage {
            flex-grow: 1;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            background-size: cover;
            background-position: center;
        }

        #character {
            position: relative;
            width: 400px;
            height: 340px;
            display: flex;
            justify-content: center;
            align-items: center;
        }



        .part {
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            pointer-events: none;
        }

        #body {
            width: 350px;
            height: 350px;
            z-index: 1;
            bottom: 0;
        }

        #face {
            width: 350px;
            height: 350px;
            z-index: 2;
            top: 0;
        }

        /* --- 目のカスタマイズ部分 --- */
        .eye-container {
            position: absolute;
            top: 70%;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 50px;
            z-index: 3;
            transform: rotate(-8deg);
        }

        /* 白目の枠（横長の楕円） */
        .eye-wrap {
            width: 80px;
            /* 白目の横幅 */
            height: 30px;
            /* 白目の高さ */
            position: relative;
            background-color: rgb(255, 255, 255);
            /* 白目の色 */
            border-radius: 50%;
            overflow: hidden;
            /* 黒目がはみ出さないようにする */
            display: flex;
            justify-content: center;
            align-items: center;
            border: 4px solid #704c19;
            /* 輪郭を少しはっきりさせる */
        }

        /* 黒目：CSS（Color）で作成する横長の楕円 */
        .eye-ball {
            width: 70px;
            /* 黒目の横幅（ここを調整！） */
            height: 25px;
            /* 黒目の高さ（ここを調整！） */
            background-color: #704c19;
            /* 黒目の色 */
            border-radius: 50%;
            /* 楕円形にする */
            position: absolute;
        }
    </style>
</head>

<body>

    <div class="menu">
        <button onclick="changeChar('cat')" id="btn-cat" class="active">ネコのお部屋</button>
        <button onclick="changeChar('bird')" id="btn-bird">トリの大空</button>
        <button onclick="changeChar('sheep')" id="btn-sheep">ヒツジの草原</button>
    </div>

    <div id="stage">
        <div id="character">
            <div class="part" id="body"></div>
            <div class="part" id="face">
                <div class="eye-container">
                    <div class="eye-wrap">
                        <div class="eye-ball" id="eyeL"></div>
                    </div>
                    <div class="eye-wrap">
                        <div class="eye-ball" id="eyeR"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <nav class="nav-bar">
            <a href="index.html" class="nav-item active"><img src="imgs/top-icon-home.png" alt=""></a>
            <a href="calendar.html" class="nav-item"><img src="imgs/top-icon-calendar.png" alt=""></a>
            <a href="puzzle.html" class="nav-item"><img src="imgs/top-icon-game.png" alt=""></a>
        </nav>
    </footer>

    <script>
        let mouseX = window.innerWidth / 2, mouseY = window.innerHeight / 2;
        let current = 'cat';

        const charData = {
            cat: {
                bg: 'imgs/character/room.png',
                body: 'imgs/character/cat_body.png',
                face: 'imgs/character/cat_face.png',
                config: {
                    isCircle: false,
                    charHeight: '340px', // ネコは元の高さ
                    speed: 0.05,
                    eyeRangeX: 8,
                    eyeRangeY: 4,
                    rotate: 0.03,
                    eyeTop: '42%',
                    eyeGap: '45px',
                    eyeRotate: '-8deg',
                    eyeSize: 1,
                    bodyZ: 1
                }
            },
            bird: {
                bg: 'imgs/character/sky.png',
                body: 'imgs/character/bird_body.png',
                face: 'imgs/character/bird_face.png',
                config: {
                    isCircle: true,
                    charHeight: '340px',
                    speed: 0.1,
                    eyeRangeX: 10,
                    eyeRangeY: 10,
                    rotate: 0.08,
                    eyeTop: '35%',
                    eyeGap: '40px',
                    eyeRotate: '0deg',
                    eyeSize: 1,
                    bodyZ: 1
                }
            },
            sheep: {
                bg: 'imgs/character/meadow.png',
                body: 'imgs/character/sheep_body.png',
                face: 'imgs/character/sheep_face.png',
                config: {
                    isCircle: false,
                    charHeight: '350px', // ヒツジだけ 350px に個別設定
                    speed: 0.02,
                    eyeRangeX: 5,
                    eyeRangeY: 5,
                    rotate: 0.01,
                    eyeTop: '40%',
                    eyeGap: '45px',
                    eyeRotate: '0deg',
                    eyeSize: 0.75,
                    bodyZ: 3
                }
            }
        };

        function changeChar(id) {
            current = id;
            const data = charData[id];
            const conf = data.config;

            document.getElementById('stage').style.backgroundImage = `url(${data.bg})`;
            document.getElementById('body').style.backgroundImage = `url(${data.body})`;
            document.getElementById('face').style.backgroundImage = `url(${data.face})`;

            // --- 追加：キャラクター枠の高さを個別に反映 ---
            document.getElementById('character').style.height = conf.charHeight;

            // --- 体と顔の前後関係を調整 ---
            document.getElementById('body').style.zIndex = conf.bodyZ;

            const container = document.querySelector('.eye-container');
            container.style.top = conf.eyeTop;
            container.style.gap = conf.eyeGap;
            container.style.transform = `rotate(${conf.eyeRotate})`;

            const eyeWraps = document.querySelectorAll('.eye-wrap');
            const eyeBalls = [document.getElementById('eyeL'), document.getElementById('eyeR')];

            eyeWraps.forEach((wrap, index) => {
                const ball = eyeBalls[index];
                const s = conf.eyeSize;

                if (conf.isCircle) {
                    wrap.style.width = (60 * s) + 'px';
                    wrap.style.height = (60 * s) + 'px';
                    ball.style.width = (30 * s) + 'px';
                    ball.style.height = (30 * s) + 'px';
                } else {
                    wrap.style.width = (80 * s) + 'px';
                    wrap.style.height = (30 * s) + 'px';
                    ball.style.width = (70 * s) + 'px';
                    ball.style.height = (30 * s) + 'px';
                }
            });

            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-' + id).classList.add('active');
        }
        window.addEventListener('mousemove', (e) => { mouseX = e.clientX; mouseY = e.clientY; });

        function loop() {
            const face = document.getElementById('face');
            const eyeL = document.getElementById('eyeL');
            const eyeR = document.getElementById('eyeR');
            const body = document.getElementById('body');

            const rect = face.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;
            const dx = mouseX - cx;
            const dy = mouseY - cy;
            const conf = charData[current].config;

            // 黒目の動きをさらに制限 (係数を 0.07 -> 0.02 に変更)
            const ex = Math.max(-conf.eyeRangeX, Math.min(conf.eyeRangeX, dx * 0.02));
            const ey = Math.max(-conf.eyeRangeY, Math.min(conf.eyeRangeY, dy * 0.02));

            eyeL.style.transform = `translate(${ex}px, ${ey}px)`;
            eyeR.style.transform = `translate(${ex}px, ${ey}px)`;

            face.style.transform = `translate(${dx * conf.speed}px, ${dy * conf.speed}px) rotate(${dx * conf.rotate}deg)`;
            body.style.transform = `translate(${dx * (conf.speed * 0.5)}px, ${dy * (conf.speed * 0.5)}px)`;

            requestAnimationFrame(loop);
        }
        changeChar('cat');
        loop();
    </script>
</body>

</html>
